# Taxi

Taxi - приложение для заказа такси. 


Функциональные требования: 

Taxi types:
1) Economy
2) Comfort
3) Business

Роли:
1) User
2) Driver

User:
1) User может зарегистрироваться. 
    - Поля для регистрации: name, phone number, email, password.
2) User может войти в систему.
    - Поля для входа: phone number, password.
3) User может выйти из системы (выданный ему токен должен перестать приниматься системой, даже если все еще валиден по времени).
4) User может заказать такси. 
    - Поля заказа: taxi type, from, to.
    - При заказе такси ищется свободный (в статусе free) водитель и, если он найден, создается order со статусом in progress. Статус водителя меняется на busy.
    - Если свободного водителя не найдено, пользователь остается в состоянии поиска водителя в течении некоторого(настраиваемого) времени. Если за это время водитель не находится, пользователю возвращается ответ с отказом.
    - При отсутствии свободных водителей из ожидающих пользователей образуется очередь. Первый заказавший такси пользователей должен первым получить водителя или сообщение, что водитель не найден.
5) User может оценить поездку. Оценить можно только последнюю поездку, если с нее прошло менее некоторого(настраиваемого) времени. Оценка от 1 до 5 включительно.
6) User может просмотреть свои поездки (taxi type, driver, from, to).
7) User может получить свой профиль (name, phone number, email, rating).
8) User может изменить поля в профиле (name, phone number, email).
9) User может удалить свой профиль (из бд не удаляется, помечается как удаленный).

Driver:
1) Driver может зарегистрироваться. 
    - Поля для регистрации: name, phone number, email, password, taxi type.
2) Driver моджет войти в систему.
    - Поля для входа: phone number, password.
3) Driver может сменить свой статус с busy на free, когда поездка закончена. При этом статус order'a меняется на finished.
4) Driver может оценить поездку. Оценить можно только последнюю поездку, если с нее прошло менее некоторого(настраиваемого) времени. Оценка от 1 до 5 включительно.
5) Driver может узнать свой общий рейтинг.
6) Driver может просмотреть свои поездки (taxi type, user, from to).
7) У Driver могут быть статусы busy и free.

Order: 
1) У Order могут быть статусы in progress и finished.
2) Поля Order: user, driver, from, to, taxi type, date, status.

Схема приложения: 

<img src="Design diagram-v2.png" width="600" height="500" /> 

Нефункциональные требования:
  
  - Gin в качестве HTTP фреймворка.
  - PostgreSQL в качестве БД.
  - MongoDB в качестве БД (сбор логов).
  - Redis в качестве кеша.
  - Swagger генерируется из аннотаций в коде.
  - Для RPC взаимодействия использовать GRPC.
  - Для каждого сервиса должен быть описан Dockerfile.
  - Поднятие всего приложения осуществлять через docker-compose. 
  - Все изменяемые переменные(подключение к бд, время ожидания юзером свободного водителя) должны устанавливаться через environment variables.
  - Для каждого сервиса должен быть настроен CI/CD на GitHub actions со степами: 1) тесты, 2) линтер.
  - Аутентификация с использованием JWT.

    Go:
  - Для реализации ожидания юзером свободных водителей использовать горутины и каналы, при необходимости пакеты sync, x/sync.
  - Для миграций использовать Goose или go-migrate.
  - Для тестирования использовать табличные тесты, gomock, testify/suite, ginkgo, gomega.
  
  - Должен быть написан десктопный клиент для заказа такси с использованием Python(Qt)
